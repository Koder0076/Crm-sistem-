<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN ‚Äì USERS</title>

<style>
body {
    background:#000;
    color:#0f0;
    font-family: monospace;
    padding:20px;
}

input, button {
    padding:10px;
    margin:5px 0;
    width:100%;
    background:#111;
    border:1px solid #0f0;
    color:#0f0;
}

button { cursor:pointer; }

table {
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}

td, th {
    border:1px solid #0f0;
    padding:6px;
}

.nav {
    margin-bottom:20px;
}
</style>
</head>

<body>

<h2>üîê ADMIN LOGIN</h2>
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">LOGIN</button>

<div id="panel" style="display:none">

    <div class="nav">
        <button onclick="location.href='earn-admin.html'">üéØ Earn Blocks Editor</button>
    </div>

    <h2>üëë USERS</h2>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Email</th>
                <th>Username</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody id="users"></tbody>
    </table>

    <!-- RESET SCORES BUTTON -->
    <button style="margin-top:20px;background:orange;color:#000"
        onclick="resetScores()">üîÑ RESET ALL SCORES</button>

    <!-- DELETE ALL -->
    <button style="margin-top:20px;background:red;color:#fff"
        onclick="deleteAllData()">‚ùå DELETE ALL DATA</button>
</div>

<script>
const ADMIN_PASSWORD = "dandelion0514";

function login() {
    if (document.getElementById("pass").value !== ADMIN_PASSWORD) {
        alert("WRONG PASSWORD");
        return;
    }
    document.getElementById("panel").style.display = "block";
    loadUsers();
}

function loadUsers() {
    fetch("/admin/users", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ password: ADMIN_PASSWORD })
    })
    .then(r=>r.json())
    .then(data=>{
        const tbody = document.getElementById("users");
        tbody.innerHTML = "";
        data.forEach(u=>{
            tbody.innerHTML += `
            <tr>
                <td>${u.id}</td>
                <td>${u.email}</td>
                <td>${u.username}</td>
                <td>${u.score || 0}</td>
            </tr>`;
        });
    });
}

function resetScores() {
    if (!confirm("‚ö†Ô∏è RESET ALL USER SCORES TO 0?")) return;

    fetch("/admin/reset-scores", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ password: ADMIN_PASSWORD })
    })
    .then(r => r.json())
    .then(d => {
        if (d.ok) {
            alert("‚úÖ ALL SCORES RESET TO 0");
            loadUsers();
        } else {
            alert("‚ùå ERROR");
        }
    });
}

function deleteAllData() {
    if (!confirm("‚ö†Ô∏è DELETE EVERYTHING?")) return;

    fetch("/admin/delete-all", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ password: ADMIN_PASSWORD })
    })
    .then(r=>r.json())
    .then(d=>{
        if (d.ok) {
            alert("üî• ALL DATA DELETED");
            location.reload();
        }
    });
}
</script>

</body>
</html>